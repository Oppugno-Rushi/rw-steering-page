<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RW‚ÄëSteering: Context Engineering for Trustworthiness</title>
  <meta name="description" content="RW‚ÄëSteering reverses undesired behavior curves under mixed and inappropriate contexts." />
  <meta property="og:title" content="RW‚ÄëSteering: Context Engineering for Trustworthiness" />
  <meta property="og:description" content="Rescorla‚ÄìWagner Steering (RW‚ÄëSteering) improves response quality by discounting inappropriate signals in context." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="./assets/figure1.png" />
  <meta name="theme-color" content="#f6e5ff" />
  <meta name="keywords" content="RW-Steering, Context Engineering, LLM, Machine Learning, AI, Trustworthiness, Rescorla-Wagner" />
  <meta name="author" content="Rushi Wang, Jiateng Liu, Cheng Qian, Yifan Shen, Yanzhou Pan, Zhaozhuo Xu, Ahmed Abbasi, Heng Ji, Denghui Zhang" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://your-domain.com/rw-steering-page/" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Preload critical resources -->
  <link rel="preload" href="./assets/figure1.png" as="image" type="image/png">
  <link rel="preload" href="./assets/figure2.png" as="image" type="image/png">
  <link rel="preload" href="./assets/figure3.png" as="image" type="image/png">
  <link rel="preload" href="./assets/figure4.png" as="image" type="image/png">
  <style>
    :root {
      /* Dreamy pastel palette */
      --bg0: #fff7ff;
      --bg1: #fef3f8;
      --bg2: #f0f5ff;
      --bg3: #f5f3ff;
      --ink: #0b1220;
      --muted: #566072;
      --accent1: #7c3aed;  /* violet */
      --accent2: #22d3ee;  /* cyan */
      --accent3: #fb7185;  /* coral */
      --card: rgba(255,255,255,.82);
      --border: rgba(2,6,23,.08);
      --shadow: 0 10px 30px rgba(17,24,39,.12);
      --radius: 16px;
    }

    * { box-sizing:border-box }
    html { scroll-behavior: smooth; }
    html, body { height:100% }
    body {
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--ink);
      /* Magical animated gradient background */
      background:
        radial-gradient(1200px 600px at -5% -10%, rgba(124,58,237,.25), transparent 60%),
        radial-gradient(900px 520px at 110% 0%, rgba(34,211,238,.28), transparent 60%),
        radial-gradient(900px 520px at 10% 120%, rgba(251,113,133,.22), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2) 45%, var(--bg3));
      background-size: 400% 400%;
      animation: magicalGradient 15s ease infinite;
      opacity: 0;
      animation: fadeIn 0.8s ease-in-out forwards;
      position: relative;
      overflow-x: hidden;
    }
    
    /* Magical floating particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(2px 2px at 20px 30px, rgba(124,58,237,0.3), transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(34,211,238,0.3), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(251,113,133,0.3), transparent),
        radial-gradient(1px 1px at 130px 80px, rgba(124,58,237,0.3), transparent),
        radial-gradient(2px 2px at 160px 30px, rgba(34,211,238,0.3), transparent);
      background-repeat: repeat;
      background-size: 200px 100px;
      animation: floatingParticles 20s linear infinite;
      pointer-events: none;
      z-index: 1;
    }
    
    @keyframes magicalGradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes floatingParticles {
      0% { transform: translateY(0px) rotate(0deg); }
      100% { transform: translateY(-100px) rotate(360deg); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .loaded {
      opacity: 1;
    }

    a { color: var(--accent1); text-decoration: none }
    .container { width:min(1100px,92%); margin-inline:auto }

    /* Nav */
    .nav { 
      position: sticky; 
      top:0; 
      z-index:10; 
      backdrop-filter: blur(12px); 
      border-bottom: 2px solid transparent;
      background: linear-gradient(135deg, rgba(255,255,255,0.8), rgba(248,250,252,0.6));
      box-shadow: 0 8px 32px rgba(124,58,237,0.1);
      position: relative;
    }
    .nav::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, 
        rgba(124,58,237,0.1), 
        rgba(34,211,238,0.1), 
        rgba(251,113,133,0.1), 
        rgba(124,58,237,0.1));
      background-size: 400% 400%;
      animation: magicalBorder 6s ease infinite;
      border-radius: 0;
      padding: 2px;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: xor;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      z-index: -1;
    }
    .nav-inner { display:flex; align-items:center; justify-content:space-between; padding:14px 0; gap:16px }
    .brand { 
      display:flex; 
      align-items:center; 
      gap:10px; 
      font-weight:800; 
      letter-spacing:.2px; 
      color:#111827;
    }
    .brand-dot { 
      width:10px; 
      height:10px; 
      border-radius:50%; 
      background:conic-gradient(from 180deg, var(--accent2), var(--accent1), var(--accent3)); 
      box-shadow:0 0 10px rgba(124,58,237,.35);
    }
    .links { display:flex; gap:18px; flex-wrap:wrap }
    .links a { 
      padding:8px 12px; 
      border-radius:12px; 
      color:var(--muted);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .links a::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(124,58,237,0.1), transparent);
      transition: left 0.5s;
    }
    .links a:hover { 
      background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(34,211,238,0.1));
      color:#7c3aed;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(124,58,237,0.2);
    }
    .links a:hover::before {
      left: 100%;
    }
    
    @keyframes magicalRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Hero */
    .hero { padding:70px 0 26px }
    .eyebrow { display:inline-flex; align-items:center; gap:8px; font-size:12.5px; color:#334155;
      background: rgba(255,255,255,.7); border:1px solid var(--border); padding:6px 10px; border-radius:999px; }
    .title { font-size: clamp(30px, 5vw, 52px); line-height:1.06; margin:14px 0 10px; font-weight:800;
      color:#0f172a; text-shadow: 0 1px 0 rgba(255,255,255,.6); }
    .title-line-1 { 
      display: block; 
      font-size: clamp(24px, 4vw, 40px); 
      color: #1e293b; 
      font-weight: 700; 
      margin-bottom: 8px; 
    }
    .title-line-2 { 
      display: block; 
      position: relative; 
    }
    .rw-text { 
      color: #1e293b; 
      font-size: clamp(32px, 5.5vw, 56px); 
      font-weight: 900; 
      display: inline-block; 
      margin-right: 12px; 
    }
    .under-text { 
      color: #374151; 
      font-size: clamp(28px, 4.5vw, 48px); 
      font-weight: 700; 
      display: inline-block; 
      opacity: 1; 
    }
    .gradient { background: linear-gradient(90deg, var(--accent2), var(--accent1)); -webkit-background-clip:text; background-clip:text; color:transparent }
    .subtitle { color: var(--muted); font-size:clamp(14px, 2.4vw, 18px) }
    .author-grid { display:flex; flex-wrap:wrap; gap:10px; margin:16px 0 18px }
    .chip { padding:7px 12px; background: rgba(255,255,255,.85); border:1px solid var(--border); border-radius:999px; color:#111827; font-size:14px }

    /* Buttons */
    .cta { display:flex; gap:12px; flex-wrap:wrap; margin-top:10px }
    .btn { 
      display:inline-flex; 
      align-items:center; 
      gap:10px; 
      padding:12px 16px; 
      border-radius:12px; 
      font-weight:600; 
      letter-spacing:.2px;
      border:1px solid var(--border); 
      background: rgba(255,255,255,.9); 
      box-shadow: var(--shadow); 
      color:#0b1220; 
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s;
    }
    .btn:hover { 
      transform: translateY(-4px) scale(1.05);
      box-shadow: 
        0 15px 30px rgba(124,58,237,0.2),
        0 5px 15px rgba(0,0,0,0.1);
    }
    .btn:hover::before {
      left: 100%;
    }
    .btn.primary { 
      background: linear-gradient(135deg, var(--accent1), var(--accent2), var(--accent3), var(--accent1));
      background-size: 300% 300%;
      color:#fff; 
      border-color: transparent;
      animation: magicalButton 3s ease infinite;
      box-shadow: 
        0 8px 25px rgba(124,58,237,0.3),
        0 0 20px rgba(34,211,238,0.2);
    }
    .btn.primary:hover {
      animation: magicalButton 1s ease infinite;
      box-shadow: 
        0 15px 35px rgba(124,58,237,0.4),
        0 0 30px rgba(34,211,238,0.3),
        0 0 40px rgba(251,113,133,0.2);
    }
    
    @keyframes magicalButton {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Cards & Sections */
    .section { padding:40px 0 }
    .card { background: var(--card); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); padding:22px }
    .h2 { font-size: 22px; margin:0 0 14px; font-weight:800; color:#0f172a }

    /* Dreamy image wrapper (float + tilt) */
    .floaty { position:relative; border-radius: 18px; overflow: hidden; border:1px solid var(--border);
      box-shadow: 0 14px 40px rgba(31,41,55,.18); transform-style: preserve-3d;
      transition: transform .2s ease, box-shadow .2s ease, filter .2s ease; }
    .floaty img { width:100%; display:block; transform: translateZ(20px); }
    .floaty::after { content:''; position:absolute; inset:-2px; border-radius: 20px;
      background: linear-gradient(120deg, rgba(124,58,237,.12), rgba(34,211,238,.12), rgba(251,113,133,.12));
      pointer-events:none; mix-blend-mode: overlay; }
    .floaty:hover { transform: translateY(-4px) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg)) scale(1.01);
      box-shadow: 0 20px 60px rgba(31,41,55,.22); }

    .caption { text-align:center; color:#475569; font-size:13.5px; margin-top:10px }

    /* Figures grid */
    .fig-grid { display:grid; grid-template-columns: 1fr; gap:20px }
    .figure { background: var(--card); border:1px solid var(--border); border-radius: 16px; padding:16px; box-shadow: var(--shadow) }
    .figure h3 { margin:0 0 10px; font-size:18px; color:#0f172a }

    /* Findings (accordion cards) */
    .findings { display:grid; gap:16px }
    details.finding { border:1px solid var(--border); border-radius:16px; background: var(--card); box-shadow: var(--shadow) }
    details.finding > summary {
      list-style:none; cursor:pointer; padding:14px 16px; border-radius:16px 16px 0 0;
      font-weight:700; background: linear-gradient(90deg, rgba(124,58,237,.18), rgba(34,211,238,.18));
      color:#0f172a; position:relative;
    }
    details.finding > summary::-webkit-details-marker { display:none }
    details.finding[open] > summary { border-bottom:1px solid var(--border) }
    details.finding .content { padding:14px 16px; color:#1f2937 }
    .badge { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; font-size:12px; background:#fff; border:1px solid var(--border) }
    
    /* Abstract Grid */
    .abstract-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
    @media (max-width: 768px) {
      .abstract-grid { grid-template-columns: 1fr; }
    }
    
    /* Figure Cards */
    .figure-card { 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9)); 
      border: 2px solid transparent;
      border-radius: 20px; 
      padding: 28px; 
      margin-bottom: 24px; 
      box-shadow: 
        0 20px 40px rgba(124,58,237,0.08), 
        0 8px 16px rgba(0,0,0,0.04),
        inset 0 1px 0 rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }
    .figure-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, 
        rgba(124,58,237,0.1), 
        rgba(34,211,238,0.1), 
        rgba(251,113,133,0.1), 
        rgba(124,58,237,0.1));
      background-size: 400% 400%;
      animation: magicalBorder 3s ease infinite;
      border-radius: 20px;
      padding: 2px;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: xor;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      z-index: -1;
    }
    .figure-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 
        0 30px 60px rgba(124,58,237,0.2), 
        0 15px 30px rgba(0,0,0,0.1),
        0 0 30px rgba(124,58,237,0.3);
    }
    .figure-card:hover::before {
      animation: magicalBorder 1s ease infinite;
    }
    
    @keyframes magicalBorder {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .figure-content { 
      display: grid; 
      grid-template-columns: 1fr 400px; 
      gap: 24px; 
      align-items: start; 
    }
    .figure-text h3 { 
      color: #1e293b; 
      font-size: 20px; 
      font-weight: 800; 
      margin: 0 0 12px 0; 
      background: linear-gradient(135deg, #7c3aed, #22d3ee); 
      -webkit-background-clip: text; 
      background-clip: text; 
      color: transparent;
    }
    .figure-description { 
      color: #475569; 
      line-height: 1.7; 
      margin: 0 0 16px 0; 
      font-size: 15px; 
    }
    .figure-badge { 
      display: inline-flex; 
      align-items: center; 
      gap: 8px; 
      padding: 10px 16px; 
      border-radius: 24px; 
      font-size: 12px; 
      background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(34,211,238,0.1)); 
      color: #7c3aed; 
      border: 1px solid rgba(124,58,237,0.2); 
      font-weight: 600;
      backdrop-filter: blur(5px);
    }
    .figure-image { 
      text-align: center; 
    }
    .figure-image img { 
      max-width: 100%; 
      height: auto; 
      border-radius: 16px; 
      box-shadow: 0 12px 30px rgba(124,58,237,0.15), 0 4px 12px rgba(0,0,0,0.08); 
      border: 1px solid rgba(124,58,237,0.1); 
      cursor: pointer; 
      transition: all 0.3s ease; 
    }
    .figure-image img:hover { 
      transform: scale(1.02) translateY(-2px); 
      box-shadow: 0 20px 40px rgba(124,58,237,0.2), 0 8px 20px rgba(0,0,0,0.12); 
    }
    
    /* Modal for enlarged image */
    .image-modal { 
      display: none; 
      position: fixed; 
      z-index: 1000; 
      left: 0; 
      top: 0; 
      width: 100%; 
      height: 100%; 
      background-color: rgba(0,0,0,0.9); 
      backdrop-filter: blur(5px); 
    }
    .image-modal-content { 
      position: absolute; 
      top: 50%; 
      left: 50%; 
      transform: translate(-50%, -50%); 
      max-width: 90%; 
      max-height: 90%; 
      border-radius: 16px; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.8); 
    }
    .image-modal img { 
      width: 100%; 
      height: auto; 
      border-radius: 16px; 
    }
    .image-modal-close { 
      position: absolute; 
      top: 20px; 
      right: 30px; 
      color: #ffffff; 
      font-size: 40px; 
      font-weight: bold; 
      cursor: pointer; 
      z-index: 1001; 
      background: rgba(0,0,0,0.5); 
      border-radius: 50%; 
      width: 50px; 
      height: 50px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      transition: background 0.3s ease; 
    }
    .image-modal-close:hover { 
      background: rgba(0,0,0,0.8); 
    }
    
    @media (max-width: 768px) {
      .figure-content { 
        grid-template-columns: 1fr; 
        gap: 16px; 
      }
      .figure-image { 
        order: -1; 
      }
    }
    
    /* Table Cards */
    .table-card { 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9)); 
      border: 1px solid rgba(34,211,238,0.12); 
      border-radius: 20px; 
      padding: 28px; 
      margin-bottom: 24px; 
      box-shadow: 0 20px 40px rgba(34,211,238,0.08), 0 8px 16px rgba(0,0,0,0.04); 
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    .table-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 25px 50px rgba(34,211,238,0.12), 0 12px 24px rgba(0,0,0,0.06);
    }
    .table-header { 
      margin-bottom: 20px; 
    }
    .table-header h3 { 
      color: #1e293b; 
      font-size: 20px; 
      font-weight: 800; 
      margin: 0 0 8px 0; 
      background: linear-gradient(135deg, #22d3ee, #fb7185); 
      -webkit-background-clip: text; 
      background-clip: text; 
      color: transparent;
    }
    .table-header p { 
      color: #64748b; 
      font-size: 14px; 
      margin: 0; 
      font-weight: 500;
    }
    .table-container { 
      overflow-x: auto; 
      border-radius: 16px; 
      background: linear-gradient(135deg, rgba(248,250,252,0.8), rgba(241,245,249,0.6)); 
      border: 1px solid rgba(34,211,238,0.1);
      backdrop-filter: blur(5px);
    }
    .data-table { 
      width: 100%; 
      border-collapse: collapse; 
      font-size: 13px; 
      min-width: 800px; 
    }
    .data-table th { 
      background: linear-gradient(135deg, rgba(34,211,238,0.1), rgba(251,113,133,0.1)); 
      color: #1e293b; 
      font-weight: 700; 
      padding: 14px 10px; 
      text-align: center; 
      border-bottom: 2px solid rgba(34,211,238,0.2); 
      font-size: 12px; 
    }
    .data-table th:first-child { 
      text-align: left; 
    }
    .data-table td { 
      color: #475569; 
      padding: 12px 10px; 
      text-align: center; 
      border-bottom: 1px solid rgba(34,211,238,0.08); 
      font-size: 12px; 
    }
    .data-table td:first-child { 
      text-align: left; 
      font-weight: 600; 
      color: #1e293b;
    }
    .data-table tbody tr:hover { 
      background: linear-gradient(135deg, rgba(34,211,238,0.05), rgba(251,113,133,0.05)); 
    }
    .highlight-cell { 
      background: linear-gradient(135deg, rgba(124,58,237,0.15), rgba(34,211,238,0.15)); 
      color: #7c3aed; 
      font-weight: 700; 
      border-radius: 6px;
    }
    
    /* Finding Bubbles */
    .finding-bubble { 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9)); 
      border: 2px solid transparent;
      border-radius: 28px; 
      padding: 32px; 
      margin-bottom: 28px; 
      box-shadow: 
        0 20px 40px rgba(124,58,237,0.08), 
        0 8px 16px rgba(0,0,0,0.04),
        inset 0 1px 0 rgba(255,255,255,0.3);
      display: flex; 
      align-items: flex-start; 
      gap: 24px; 
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
      position: relative; 
      overflow: hidden; 
      backdrop-filter: blur(10px);
    }
    .finding-bubble::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, 
        rgba(124,58,237,0.1), 
        rgba(34,211,238,0.1), 
        rgba(251,113,133,0.1), 
        rgba(124,58,237,0.1));
      background-size: 400% 400%;
      animation: magicalBorder 4s ease infinite;
      border-radius: 28px;
      padding: 2px;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: xor;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      z-index: -1;
    }
    .finding-bubble::before { 
      content: ''; 
      position: absolute; 
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0; 
      background: linear-gradient(135deg, rgba(124,58,237,0.05), rgba(34,211,238,0.05)); 
      opacity: 0; 
      transition: opacity 0.3s ease; 
      pointer-events: none; 
    }
    .finding-bubble:hover { 
      transform: translateY(-8px) scale(1.02); 
      box-shadow: 0 25px 50px rgba(124,58,237,0.15), 0 12px 24px rgba(0,0,0,0.08); 
    }
    .finding-bubble:hover::before { 
      opacity: 1; 
    }
    
    /* Different colored finding numbers */
    .finding-number { 
      color: #ffffff; 
      font-size: 20px; 
      font-weight: 900; 
      width: 56px; 
      height: 56px; 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      flex-shrink: 0; 
      position: relative; 
      z-index: 2; 
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    .finding-number-1 { 
      background: linear-gradient(135deg, #ef4444, #f97316, #ef4444);
      background-size: 200% 200%;
      box-shadow: 
        0 6px 20px rgba(239,68,68,0.4), 
        0 0 0 4px rgba(239,68,68,0.1),
        0 0 20px rgba(239,68,68,0.3);
      animation: magicalPulse 2s ease-in-out infinite;
    }
    .finding-number-2 { 
      background: linear-gradient(135deg, #3b82f6, #06b6d4, #3b82f6);
      background-size: 200% 200%;
      box-shadow: 
        0 6px 20px rgba(59,130,246,0.4), 
        0 0 0 4px rgba(59,130,246,0.1),
        0 0 20px rgba(59,130,246,0.3);
      animation: magicalPulse 2.5s ease-in-out infinite;
    }
    .finding-number-3 { 
      background: linear-gradient(135deg, #10b981, #059669, #10b981);
      background-size: 200% 200%;
      box-shadow: 
        0 6px 20px rgba(16,185,129,0.4), 
        0 0 0 4px rgba(16,185,129,0.1),
        0 0 20px rgba(16,185,129,0.3);
      animation: magicalPulse 3s ease-in-out infinite;
    }
    .finding-number-4 { 
      background: linear-gradient(135deg, #8b5cf6, #a855f7, #8b5cf6);
      background-size: 200% 200%;
      box-shadow: 
        0 6px 20px rgba(139,92,246,0.4), 
        0 0 0 4px rgba(139,92,246,0.1),
        0 0 20px rgba(139,92,246,0.3);
      animation: magicalPulse 3.5s ease-in-out infinite;
    }
    
    @keyframes magicalPulse {
      0%, 100% { 
        background-position: 0% 50%;
        transform: scale(1);
        box-shadow: 
          0 6px 20px rgba(0,0,0,0.2), 
          0 0 0 4px rgba(0,0,0,0.1),
          0 0 20px rgba(0,0,0,0.2);
      }
      50% { 
        background-position: 100% 50%;
        transform: scale(1.1);
        box-shadow: 
          0 8px 25px rgba(0,0,0,0.3), 
          0 0 0 6px rgba(0,0,0,0.15),
          0 0 30px rgba(0,0,0,0.4);
      }
    }
    
    /* Special effects for each finding */
    .finding-1 { 
      border-left: 4px solid #ef4444; 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254,242,242,0.9)); 
    }
    .finding-2 { 
      border-left: 4px solid #3b82f6; 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(239,246,255,0.9)); 
    }
    .finding-3 { 
      border-left: 4px solid #10b981; 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(236,253,245,0.9)); 
    }
    .finding-4 { 
      border-left: 4px solid #8b5cf6; 
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(245,243,255,0.9)); 
    }
    .finding-content { 
      flex: 1; 
    }
    .finding-content h3 { 
      color: #1e293b; 
      font-size: 18px; 
      font-weight: 700; 
      margin: 0 0 12px 0; 
      line-height: 1.4; 
    }
    .finding-content p { 
      color: #475569; 
      line-height: 1.7; 
      margin: 0 0 16px 0; 
      font-size: 15px; 
    }
    .finding-tags { 
      display: flex; 
      gap: 8px; 
      flex-wrap: wrap; 
    }
    .finding-tag { 
      background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(34,211,238,0.1)); 
      color: #7c3aed; 
      padding: 8px 14px; 
      border-radius: 24px; 
      font-size: 12px; 
      font-weight: 600; 
      border: 1px solid rgba(124,58,237,0.2); 
      backdrop-filter: blur(5px);
    }
    
    @media (max-width: 768px) {
      .finding-bubble { 
        flex-direction: column; 
        gap: 16px; 
        text-align: center; 
        padding: 24px;
      }
      .finding-number { 
        align-self: center; 
      }
      .figure-content { 
        grid-template-columns: 1fr; 
        gap: 16px; 
      }
      .figure-image { 
        order: -1; 
      }
      .abstract-grid { 
        grid-template-columns: 1fr; 
        gap: 16px;
      }
      .cta {
        justify-content: center;
      }
      .author-grid {
        justify-content: center;
      }
      .nav-inner {
        flex-direction: column;
        gap: 12px;
      }
      .links {
        justify-content: center;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        width: 95%;
      }
      .hero {
        padding: 40px 0 20px;
      }
      .title {
        font-size: clamp(24px, 8vw, 36px);
      }
      .figure-card, .table-card, .finding-bubble {
        padding: 20px;
        margin-bottom: 16px;
      }
    }
  </style>
</head>
<body>
  <header class="nav">
    <div class="container nav-inner">
      <div class="brand"><span class="brand-dot"></span> RW‚ÄëSteering</div>
      <nav class="links">
        <a href="#abstract">Abstract</a>
        <a href="#figures">Figures</a>
        <a href="#tables">Tables</a>
        <a href="#findings">Findings</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- HERO -->
    <section class="hero">
      <h1 class="title">
        <span class="title-line-1">Context Engineering for Trustworthiness:</span><br>
        <span class="title-line-2">
          <span class="rw-text">Rescorla‚ÄìWagner Steering</span><br>
          <span class="under-text">Under Mixed and Inappropriate Contexts</span>
        </span>
      </h1>
      <p class="subtitle">A simple, generalizable approach to make LLMs internally identify and ignore inappropriate signals in mixed contexts.</p>

      <div class="author-grid" aria-label="authors">
        <span class="chip">Rushi Wang</span>
        <span class="chip">Jiateng Liu</span>
        <span class="chip">Cheng Qian</span>
        <span class="chip">Yifan Shen</span>
        <span class="chip">Yanzhou Pan</span>
        <span class="chip">Zhaozhuo Xu</span>
        <span class="chip">Ahmed Abbasi</span>
        <span class="chip">Heng Ji</span>
        <span class="chip">Denghui Zhang</span>
      </div>
      <div class="subtitle">UIUC ‚ô° ‚Ä¢ Google ‚ô£ ‚Ä¢ Notre Dame ‚ô† ‚Ä¢ Stevens ‚ô¢</div>

      <div class="cta">
        <a class="btn primary" href="https://arxiv.org/abs/2509.04500" target="_blank" rel="noopener">üìù arXiv</a>
        <a class="btn" href="https://arxiv.org/pdf/2509.04500" target="_blank" rel="noopener">üìÑ PDF</a>
        <a class="btn" href="https://github.com/Oppugno-Rushi/RW-Steering" target="_blank" rel="noopener">üíª Code</a>
      </div>

    </section>

    <!-- ABSTRACT -->
    <section class="section" id="abstract">
      <div class="abstract-grid">
        <!-- Abstract Card -->
        <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9)); border: 1px solid rgba(124,58,237,0.15); border-radius: 20px; padding: 28px; box-shadow: 0 20px 40px rgba(124,58,237,0.08), 0 8px 16px rgba(0,0,0,0.04); backdrop-filter: blur(10px);">
          <h2 style="color: #1e293b; font-size: 24px; font-weight: 800; margin: 0 0 16px 0; background: linear-gradient(135deg, #7c3aed, #22d3ee); -webkit-background-clip: text; background-clip: text; color: transparent;">Abstract</h2>
          <p style="color: #475569; line-height: 1.7; margin: 0; font-size: 15px;">
            We construct a <em style="color: #7c3aed; font-weight: 600;">Poisoned Context Testbed</em> pairing queries with realistic mixed context and adapt
            a Rescorla‚ÄìWagner (RW) model to explain how competing contextual signals steer LLM behavior.
            Even small amounts of inappropriate information can disproportionately degrade responses.
            We propose <strong style="color: #22d3ee; font-weight: 700;">RW‚ÄëSteering</strong>, a two‚Äëstage fine‚Äëtuning approach that trains models to internally identify
            and discount inappropriate signals, reversing the undesired behavior curves and improving response quality.
          </p>
        </div>
        
        <!-- Highlights Card -->
        <div style="background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9)); border: 1px solid rgba(34,211,238,0.15); border-radius: 20px; padding: 28px; box-shadow: 0 20px 40px rgba(34,211,238,0.08), 0 8px 16px rgba(0,0,0,0.04); backdrop-filter: blur(10px);">
          <h2 style="color: #1e293b; font-size: 24px; font-weight: 800; margin: 0 0 16px 0; background: linear-gradient(135deg, #22d3ee, #fb7185); -webkit-background-clip: text; background-clip: text; color: transparent;">Highlights</h2>
          <ul style="color: #475569; line-height: 1.7; margin: 0 0 20px 0; padding-left: 20px; font-size: 15px;">
            <li><strong style="color: #7c3aed; font-weight: 600;">Behavioral insight:</strong> Small amounts of inappropriate context can disproportionately steer LLM behavior</li>
            <li><strong style="color: #22d3ee; font-weight: 600;">Testbed:</strong> Poisoned Context Testbed with realistic mixed contexts</li>
            <li><strong style="color: #fb7185; font-weight: 600;">Method:</strong> RW-Steering reverses undesired behavior curves</li>
          </ul>
          
          <!-- Summary Badges -->
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <div style="background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(168,85,247,0.1)); border: 1px solid rgba(124,58,237,0.2); border-radius: 16px; padding: 16px 20px; text-align: center; min-width: 120px; backdrop-filter: blur(5px);">
              <div style="color: #7c3aed; font-size: 20px; font-weight: 800; margin: 0;">+39.8%</div>
              <div style="color: #64748b; font-size: 12px; margin: 4px 0 0 0; font-weight: 500;">Avg. response quality</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(5,150,105,0.1)); border: 1px solid rgba(16,185,129,0.2); border-radius: 16px; padding: 16px 20px; text-align: center; min-width: 120px; backdrop-filter: blur(5px);">
              <div style="color: #10b981; font-size: 20px; font-weight: 800; margin: 0;">K ‚â§ 3</div>
              <div style="color: #64748b; font-size: 12px; margin: 4px 0 0 0; font-weight: 500;">Robust to minor contamination</div>
            </div>
            <div style="background: linear-gradient(135deg, rgba(34,211,238,0.1), rgba(14,165,233,0.1)); border: 1px solid rgba(34,211,238,0.2); border-radius: 16px; padding: 16px 20px; text-align: center; min-width: 120px; backdrop-filter: blur(5px);">
              <div style="color: #22d3ee; font-size: 20px; font-weight: 800; margin: 0;">Generalizes</div>
              <div style="color: #64748b; font-size: 12px; margin: 4px 0 0 0; font-weight: 500;">Across mixture ratios</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FIGURES -->
    <section class="section" id="figures">
      <h2 class="h2">Figures</h2>
      
      <!-- Figure 1 -->
      <div class="figure-card">
        <div class="figure-content">
          <div class="figure-text">
            <h3>Poisoned Context Testbed</h3>
            <p class="figure-description">
              We construct a realistic testbed that pairs user queries with mixed contexts containing both appropriate and inappropriate information. 
              <strong style="color: #fbbf24;">Key insight:</strong> Even small amounts of inappropriate content (as little as 5-10%) can significantly mislead LLM responses, 
              demonstrating the vulnerability of current models to contextual contamination.
            </p>
            <div class="figure-badge">Testbed Design ‚Ä¢ Mixed Contexts ‚Ä¢ Vulnerability Analysis</div>
          </div>
          <div class="figure-image">
            <img src="./assets/figure1.png" alt="Figure 1: Poisoned Context Testbed" onclick="openImageModal(this)">
          </div>
        </div>
      </div>

      <!-- Figure 2 -->
      <div class="figure-card">
        <div class="figure-content">
          <div class="figure-text">
            <h3>RW Model vs. LLM Behavior Curves</h3>
            <p class="figure-description">
              The adapted Rescorla-Wagner model accurately predicts LLM behavior patterns under mixed contexts. 
              <strong style="color: #60a5fa;">Critical finding:</strong> Performance degradation follows predictable curves, with early inappropriate signals 
              having disproportionate impact, validating our theoretical framework.
            </p>
            <div class="figure-badge">Modeling ‚Ä¢ Predictive Accuracy ‚Ä¢ Early Signal Impact</div>
          </div>
          <div class="figure-image">
            <img src="./assets/figure2.png" alt="Figure 2: RW model vs. LLM behavior curves" onclick="openImageModal(this)">
          </div>
        </div>
      </div>

      <!-- Figure 3 -->
      <div class="figure-card">
        <div class="figure-content">
          <div class="figure-text">
            <h3>RW‚ÄëSteering vs. Baselines</h3>
            <p class="figure-description">
              Comparison of our RW-Steering approach against three baseline methods: alignment-only, awareness-based, and context filtering. 
              <strong style="color: #10b981;">Advantage:</strong> RW-Steering uniquely combines joint judgment-answer optimization with targeted training 
              on inappropriate segments, achieving superior generalization across contamination levels.
            </p>
            <div class="figure-badge">Method Comparison ‚Ä¢ Joint Optimization ‚Ä¢ Superior Generalization</div>
          </div>
          <div class="figure-image">
            <img src="./assets/figure3.png" alt="Figure 3: RW-Steering vs. baselines" onclick="openImageModal(this)">
          </div>
        </div>
      </div>

      <!-- Figure 4 -->
      <div class="figure-card">
        <div class="figure-content">
          <div class="figure-text">
            <h3>Behavior Curve Reversal</h3>
            <p class="figure-description">
              RW-Steering successfully reverses the undesired behavior curves observed in baseline methods. 
              <strong style="color: #f59e0b;">Key result:</strong> Our approach maintains stable, high-quality responses across all contamination levels (0-95%), 
              demonstrating robust performance even under extreme contextual challenges.
            </p>
            <div class="figure-badge">Curve Reversal ‚Ä¢ Stable Performance ‚Ä¢ Extreme Robustness</div>
          </div>
          <div class="figure-image">
            <img src="./assets/figure4.png" alt="Figure 4: Behavior curve reversal" onclick="openImageModal(this)">
          </div>
        </div>
      </div>
    </section>

    <!-- TABLES -->
    <section class="section" id="tables">
      <h2 class="h2">Tables</h2>
      
      <!-- Table 1 -->
      <div class="table-card">
        <div class="table-header">
          <h3>Table 1 ‚Äî Results on Models Exposed to Proportionate Fakenews Context</h3>
          <p>Consistency and Cleanliness evaluation metrics across different models and methods</p>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Model</th>
                <th>Eval</th>
                <th>With context</th>
                <th>No context</th>
                <th>Self‚ÄëAligned</th>
                <th>Human‚ÄëAligned</th>
                <th>Self‚ÄëEnhanced</th>
                <th>Human‚ÄëAligned (Awareness)</th>
                <th>Context Filtering</th>
                <th>RW‚ÄëSteering</th>
              </tr>
            </thead>
            <tbody>
              <tr><td rowspan="2"><em>Phi‚Äë2</em></td><td>Consistency</td><td>66.3</td><td>48.5</td><td>82.3</td><td>80.7</td><td>77.9</td><td>79.8</td><td>75.6</td><td class="highlight-cell">76.2</td></tr>
              <tr><td>Cleanliness</td><td>53.0</td><td>75.5</td><td>79.4</td><td>80.6</td><td>82.6</td><td>81.4</td><td>58.5</td><td class="highlight-cell">83.9</td></tr>

              <tr><td rowspan="2"><em>Qwen2‚Äë1.5B</em></td><td>Consistency</td><td>62.7</td><td>46.1</td><td>70.8</td><td>74.4</td><td>68.4</td><td>68.4</td><td>66.3</td><td class="highlight-cell">72.9</td></tr>
              <tr><td>Cleanliness</td><td>51.2</td><td>83.3</td><td>83.5</td><td>77.8</td><td>82.1</td><td>78.6</td><td>53.1</td><td class="highlight-cell">82.0</td></tr>

              <tr><td rowspan="2"><em>gemma‚Äë2‚Äë2b</em></td><td>Consistency</td><td>67.4</td><td>52.5</td><td>73.5</td><td>74.3</td><td>69.0</td><td>72.4</td><td>69.1</td><td class="highlight-cell">73.9</td></tr>
              <tr><td>Cleanliness</td><td>55.3</td><td>88.8</td><td>88.2</td><td>75.5</td><td>86.4</td><td>78.3</td><td>58.1</td><td class="highlight-cell">87.5</td></tr>

              <tr><td rowspan="2"><em>Llama‚Äë3.2‚Äë1B</em></td><td>Consistency</td><td>68.1</td><td>44.6</td><td>72.3</td><td>75.0</td><td>70.1</td><td>73.2</td><td>68.1</td><td class="highlight-cell">74.1</td></tr>
              <tr><td>Cleanliness</td><td>64.8</td><td>84.9</td><td>85.3</td><td>76.9</td><td>85.9</td><td>77.9</td><td>72.2</td><td class="highlight-cell">85.4</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Table 2 -->
      <div class="table-card">
        <div class="table-header">
          <h3>Table 2 ‚Äî Results on Qwen2 Model Exposed to Disproportionate Inappropriate Context</h3>
          <p>Response Quality evaluation across contamination levels (0-45%)</p>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>0%</th>
                <th>5%</th>
                <th>10%</th>
                <th>15%</th>
                <th>20%</th>
                <th>25%</th>
                <th>30%</th>
                <th>35%</th>
                <th>40%</th>
                <th>45%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><em>Baseline (With Context)</em></td>
                <td>74.1</td>
                <td>61.9</td>
                <td>59.2</td>
                <td>54.6</td>
                <td>57.1</td>
                <td>59.3</td>
                <td>54.8</td>
                <td>57.4</td>
                <td>56.4</td>
                <td>56.7</td>
              </tr>
              <tr>
                <td><em>Context Filtering</em></td>
                <td>74.9</td>
                <td>72.7</td>
                <td>72.1</td>
                <td>64.7</td>
                <td>59.9</td>
                <td>58.4</td>
                <td>59.2</td>
                <td>60.7</td>
                <td>59.1</td>
                <td>59.5</td>
              </tr>
              <tr>
                <td><em>RW‚ÄëSteering</em></td>
                <td class="highlight-cell">77.6</td>
                <td class="highlight-cell">76.4</td>
                <td class="highlight-cell">75.1</td>
                <td class="highlight-cell">75.8</td>
                <td class="highlight-cell">76.1</td>
                <td class="highlight-cell">75.8</td>
                <td class="highlight-cell">76.2</td>
                <td class="highlight-cell">75.3</td>
                <td class="highlight-cell">77.2</td>
                <td class="highlight-cell">76.9</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Table 2 (continued) -->
      <div class="table-card">
        <div class="table-header">
          <h3>Table 2 (continued) ‚Äî Results on Qwen2 Model Exposed to Disproportionate Inappropriate Context</h3>
          <p>Response Quality evaluation across contamination levels (50-95%)</p>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>50%</th>
                <th>55%</th>
                <th>60%</th>
                <th>65%</th>
                <th>70%</th>
                <th>75%</th>
                <th>80%</th>
                <th>85%</th>
                <th>90%</th>
                <th>95%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><em>Baseline (With Context)</em></td>
                <td>55.2</td>
                <td>53.8</td>
                <td>53.7</td>
                <td>54.8</td>
                <td>53.9</td>
                <td>54.3</td>
                <td>51.5</td>
                <td>50.8</td>
                <td>49.0</td>
                <td>47.8</td>
              </tr>
              <tr>
                <td><em>Context Filtering</em></td>
                <td>61.2</td>
                <td>61.4</td>
                <td>59.2</td>
                <td>62.5</td>
                <td>58.6</td>
                <td>61.1</td>
                <td>57.3</td>
                <td>55.7</td>
                <td>54.5</td>
                <td>55.5</td>
              </tr>
              <tr>
                <td><em>RW‚ÄëSteering</em></td>
                <td class="highlight-cell">75.5</td>
                <td class="highlight-cell">76.9</td>
                <td class="highlight-cell">76.8</td>
                <td class="highlight-cell">76.1</td>
                <td class="highlight-cell">78.2</td>
                <td class="highlight-cell">76.1</td>
                <td class="highlight-cell">76.5</td>
                <td class="highlight-cell">74.5</td>
                <td class="highlight-cell">74.1</td>
                <td class="highlight-cell">76.2</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- FINDINGS -->
    <section class="section" id="findings">
      <h2 class="h2">Findings</h2>
      
      <!-- Finding 1 -->
      <div class="finding-bubble finding-1">
        <div class="finding-number finding-number-1">01</div>
        <div class="finding-content">
          <h3>Small amounts of inappropriate context can disproportionately steer LLM behavior</h3>
          <p>Evidence from the testbed shows that early or salient inappropriate signals induce large behavior shifts ("RW behavior"), even when they represent a minority of the context.</p>
          <div class="finding-tags">
            <span class="finding-tag">RW behavior</span>
            <span class="finding-tag">Minority but salient signals</span>
          </div>
        </div>
      </div>

      <!-- Finding 2 -->
      <div class="finding-bubble finding-2">
        <div class="finding-number finding-number-2">02</div>
        <div class="finding-content">
          <h3>RW model explains and predicts the shape of behavior curves</h3>
          <p>The adapted Rescorla‚ÄìWagner model closely predicts performance degradation patterns under mixed contexts, aligning with empirical curves across contamination levels.</p>
          <div class="finding-tags">
            <span class="finding-tag">Modeling</span>
            <span class="finding-tag">Predictive alignment</span>
          </div>
        </div>
      </div>

      <!-- Finding 3 -->
      <div class="finding-bubble finding-3">
        <div class="finding-number finding-number-3">03</div>
        <div class="finding-content">
          <h3>Alignment-only and filtering baselines fail to generalize across mixture ratios</h3>
          <p>Self-/human-aligned responses and rule-based filtering offer limited stability and may collapse as mixture ratios change.</p>
          <div class="finding-tags">
            <span class="finding-tag">Baselines</span>
            <span class="finding-tag">Generalization gap</span>
          </div>
        </div>
      </div>

      <!-- Finding 4 -->
      <div class="finding-bubble finding-4">
        <div class="finding-number finding-number-4">04</div>
        <div class="finding-content">
          <h3>RW‚ÄëSteering reverses the undesired curve and improves overall quality</h3>
          <p>With a joint judgment + answer objective and extra training on few inappropriate segments, RW‚ÄëSteering generalizes robustly and improves average response quality.</p>
          <div class="finding-tags">
            <span class="finding-tag">Generalization</span>
            <span class="finding-tag">+Quality</span>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Image Modal -->
  <div id="imageModal" class="image-modal" onclick="closeImageModal()">
    <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
    <div class="image-modal-content" onclick="event.stopPropagation()">
      <img id="modalImage" src="" alt="">
    </div>
  </div>


  <script>
    // Image modal functions
    function openImageModal(img) {
      const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('modalImage');
      modal.style.display = 'block';
      modalImg.src = img.src;
      modalImg.alt = img.alt;
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
      modal.focus(); // Focus for accessibility
    }

    function closeImageModal() {
      const modal = document.getElementById('imageModal');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto'; // Restore scrolling
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeImageModal();
      }
    });

    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Lazy loading for images
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove('lazy');
            imageObserver.unobserve(img);
          }
        });
      });

      document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
      });
    }

    // Subtle tilt effect on elements with .tilt
    for (const el of document.querySelectorAll('.tilt')) {
      el.addEventListener('mousemove', (e) => {
        const r = el.getBoundingClientRect();
        const mx = (e.clientX - r.left) / r.width - 0.5;
        const my = (e.clientY - r.top) / r.height - 0.5;
        el.style.setProperty('--rx', `${-my*3}deg`);
        el.style.setProperty('--ry', `${mx*3}deg`);
      });
      el.addEventListener('mouseleave', () => {
        el.style.setProperty('--rx', '0deg');
        el.style.setProperty('--ry', '0deg');
      });
    }

    // Add loading animation
    window.addEventListener('load', function() {
      document.body.classList.add('loaded');
    });

    // Magical cursor trail effect
    let mouseX = 0, mouseY = 0;
    let trail = [];
    const trailLength = 20;

    document.addEventListener('mousemove', function(e) {
      mouseX = e.clientX;
      mouseY = e.clientY;
      
      // Add trail point
      trail.push({x: mouseX, y: mouseY, time: Date.now()});
      
      // Remove old trail points
      trail = trail.filter(point => Date.now() - point.time < 1000);
      
      // Create magical sparkles
      if (Math.random() < 0.1) {
        createSparkle(mouseX, mouseY);
      }
    });

    function createSparkle(x, y) {
      const sparkle = document.createElement('div');
      sparkle.style.cssText = `
        position: fixed;
        left: ${x}px;
        top: ${y}px;
        width: 4px;
        height: 4px;
        background: radial-gradient(circle, rgba(124,58,237,0.8), transparent);
        border-radius: 50%;
        pointer-events: none;
        z-index: 9999;
        animation: sparkleFade 1s ease-out forwards;
      `;
      document.body.appendChild(sparkle);
      
      setTimeout(() => sparkle.remove(), 1000);
    }

    // Add sparkle animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes sparkleFade {
        0% { 
          transform: scale(0) rotate(0deg);
          opacity: 1;
        }
        100% { 
          transform: scale(1) rotate(180deg);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);

    // Magical scroll effects
    let ticking = false;
    function updateScrollEffects() {
      const scrolled = window.pageYOffset;
      const parallax = scrolled * 0.5;
      
      // Update background position
      document.body.style.backgroundPosition = `0% ${50 + parallax * 0.1}%`;
      
      // Update particle animation
      const particles = document.querySelector('body::before');
      if (particles) {
        particles.style.transform = `translateY(${parallax * 0.2}px)`;
      }
      
      ticking = false;
    }

    window.addEventListener('scroll', function() {
      if (!ticking) {
        requestAnimationFrame(updateScrollEffects);
        ticking = true;
      }
    });

    // Magical hover effects for cards
    document.querySelectorAll('.figure-card, .table-card, .finding-bubble').forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-8px) scale(1.02) rotateX(5deg)';
        this.style.boxShadow = '0 30px 60px rgba(124,58,237,0.3), 0 0 40px rgba(34,211,238,0.2)';
      });
      
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0) scale(1) rotateX(0deg)';
        this.style.boxShadow = '';
      });
    });
  </script>
</body>
</html>
